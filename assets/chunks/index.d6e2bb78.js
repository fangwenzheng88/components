import{d as x}from"./is.816509ab.js";import"./use-popup-manager.89fcdf2b.js";import{c as O}from"./index.0215b6be.js";import{h as W,x as R,y as _,O as A}from"./framework.6989a421.js";function b(h,l,r="children"){P(h,l,r,[])}function P(h,l,r="children",s=[]){const a=[];for(const d of h)a.push({node:d,parents:s});for(;a.length>0;){const{node:d,parents:c}=a.shift();l&&l(d,c);const f=d[r];if(Array.isArray(f))for(const u of f)a.push({node:u,parents:[d,...c]})}}function w(h){const l=[];for(const r of h)if(r.visible!==!1){const{children:s}=r;if(Array.isArray(s)&&s.length>0){const a=w(s);a.length>0&&l.push({...r,children:a})}else l.push({...r,_originWidth:r.width})}return l}function T(h){const l=O(h),r=W(h),s=W(null),a=W([]);let d=0;const c=new ResizeObserver(o=>{const i=o[0];i.contentRect.width!==d&&(d=i.contentRect.width,p())});R(s,()=>{c.disconnect(),s.value&&c.observe(s.value.$el)});const f=W([]);_(()=>{f.value=w(r.value),a.value=u(f.value).map(o=>o.dataIndex),A(()=>{p()})});function u(o){const i=[];return o.forEach(e=>{e.children&&e.children.length>0?i.push(...u(e.children)):i.push(e)}),i}function y(){return u(f.value)}function p(){if(!s.value)return;const o=s.value.$el.querySelector(".arco-table-content").clientWidth;let i=0;const e=y(),n=e.filter(t=>typeof t._originWidth!="number");if(n.length>0)if(e.forEach(t=>{i+=Number(t._originWidth??t.minWidth??80)}),i<=o){const t=o-i;if(n.length===1)n[0].width=Number(n[0].minWidth??80)+t;else{const D=n.reduce((m,v)=>m+Number(v.minWidth??80),0),F=t/D;let g=0;n.forEach((m,v)=>{if(v===0)return;const C=Math.floor(Number(m.minWidth??80)*F);g+=C,m.width=Number(m.minWidth??80)+C}),n[0].width=Number(n[0].minWidth??80)+t-g}}else n.forEach(t=>{t.width=Number(t.minWidth)});else e.forEach(t=>{x(t._originWidth)&&x(t.minWidth)?t.width=80:t.width=Number(t._originWidth??t.minWidth)})}function N(){r.value=l}function I(o,i){b(r.value,e=>{e.dataIndex===o&&Object.keys(e).forEach(n=>{Object.prototype.hasOwnProperty.call(i,n)?e[n]=i[n]:delete e[n]})})}function E(o,i,e){b(r.value,n=>{n.dataIndex===o&&(n[i]=e)})}function B(o,i){b(r.value,e=>{e.dataIndex===o&&(e.visible=i)})}return{ref(o){s.value=o},tableInstance:s,originColumns:r,columns:f,columnKeys:a,resetColumns:N,updateColumnsWidth:p,changeColumnVisibleByDataIndex:B,updateColumnByDataIndex:E,replaceColumnByDataIndex:I}}export{T as u};
