import"./dayjs.min.c0ea899f.js";import{c as O}from"./cloneDeep.4d284b0e.js";import{h as W,x as R,y as _,O as A}from"./framework.dd579901.js";function b(a,l,r="children"){D(a,l,r,[])}function D(a,l,r="children",s=[]){const h=[];for(const d of a)h.push({node:d,parents:s});for(;h.length>0;){const{node:d,parents:c}=h.shift();l&&l(d,c);const f=d[r];if(Array.isArray(f))for(const u of f)h.push({node:u,parents:[d,...c]})}}function x(a){const l=[];for(const r of a)if(r.visible!==!1){const{children:s}=r;if(Array.isArray(s)&&s.length>0){const h=x(s);h.length>0&&l.push({...r,children:h})}else l.push({...r,_originWidth:r.width})}return l}function q(a){const l=O(a),r=W(a),s=W(null),h=W([]);let d=0;const c=new ResizeObserver(o=>{const i=o[0];i.contentRect.width!==d&&(d=i.contentRect.width,p())});R(s,()=>{c.disconnect(),s.value&&c.observe(s.value.$el)});const f=W([]);_(()=>{f.value=x(r.value),h.value=u(f.value).map(o=>o.dataIndex),A(()=>{p()})});function u(o){const i=[];return o.forEach(e=>{e.children&&e.children.length>0?i.push(...u(e.children)):i.push(e)}),i}function w(){return u(f.value)}function p(){if(!s.value)return;const o=s.value.$el.querySelector(".arco-table-content").clientWidth;let i=0;const e=w(),n=e.filter(t=>typeof t._originWidth!="number");if(n.length>0)if(e.forEach(t=>{i+=Number(t._originWidth||t.minWidth||80)}),i<=o){const t=o-i;if(n.length===1)n[0].width=Number(n[0].minWidth||80)+t;else{const B=n.reduce((m,v)=>m+Number(v.minWidth||80),0),F=t/B;let g=0;n.forEach((m,v)=>{if(v===0)return;const C=Math.floor(Number(m.minWidth||80)*F);g+=C,m.width=Number(m.minWidth||80)+C}),n[0].width=Number(n[0].minWidth||80)+t-g}}else n.forEach(t=>{t.width=Number(t.minWidth)});else e.forEach(t=>{!t._originWidth&&!t.minWidth?t.width=80:t.width=Number(t._originWidth||t.minWidth)})}function y(){r.value=l}function N(o,i){b(r.value,e=>{e.dataIndex===o&&Object.keys(e).forEach(n=>{Object.prototype.hasOwnProperty.call(i,n)?e[n]=i[n]:delete e[n]})})}function I(o,i,e){b(r.value,n=>{n.dataIndex===o&&(n[i]=e)})}function E(o,i){b(r.value,e=>{e.dataIndex===o&&(e.visible=i)})}return{ref(o){s.value=o},tableInstance:s,originColumns:r,columns:f,columnKeys:h,resetColumns:y,updateColumnsWidth:p,changeColumnVisibleByDataIndex:E,updateColumnByDataIndex:I,replaceColumnByDataIndex:N}}export{q as u};
